
@{
    ViewBag.Title = "Edit";
    _4S.Model.T_Base_Service ser = ViewBag.model;
}

<div class="row">
    <div class="col-md-12">
        <h1>编辑维修记录</h1>
    </div>
</div>
<div class="row mb-5">
    <div class="col-md-12">
        <div class="card">
            <div class="card-body">
                <div class="row">
                    <div class="col-lg-12">
                        <p class="lead">
                            Click "Validate" below to see the validation in action
                        </p>
                        <form action="" id="formAdd">
                            <div class="form-group">
                                <input type="hidden" name="Id" value=@ser.Id>
                                <label for="Brand" class="active">品牌</label>
                                <input type="text" class="form-control" name="Brand" id="Brand" value="@ser.Brand" data-validation="length alphanumeric"
                                       data-validation-length="3-12"
                                       data-validation-error-msg="Username has to be an alphanumeric value (3-12 chars)" placeholder="Brand">
                            </div>

                            <div class="form-group">
                                <label for="CarModel" class="active">车型</label>
                                <input type="text" class="form-control" id="CarModel" name="CarModel" value="@ser.CarModel" data-validation="strength" placeholder="CarModel">
                            </div>

                            <div class="form-group">
                                <label for="Modeldetail" class="active">款式</label>
                                <input type="text" class="form-control" name="Modeldetail" id="Modeldetail" value="@ser.Modeldetail" placeholder="Modeldetail">
                            </div>

                            <div class="form-group">
                                <label for="Price" class="active">维修价格</label>
                                <input type="text" class="form-control" id="Price" name="Price" value="@ser.Price" placeholder="Price">
                            </div>

                            <div class="form-group">
                                <label for="FaultType" class="active">故障类型</label>
                                <div class="input-group mb-3">
                                    <div class="form-check form-check-inline">
                                        @if (ser.FaultType.IndexOf("发动机") != -1)
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox1" value="发动机" checked="checked">
                                        }
                                        else
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox1" value="发动机">
                                        }
                                        <label class="form-check-label" for="inlineCheckbox1">发动机</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        @if (ser.FaultType.IndexOf("变速箱") != -1)
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox2" value="变速箱" checked="checked">
                                        }
                                        else
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox2" value="变速箱">
                                        }

                                        <label class="form-check-label" for="inlineCheckbox2">变速箱</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        @if (ser.FaultType.IndexOf("刹车") != -1)
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox3" value="刹车" checked="checked">
                                        }
                                        else
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox3" value="刹车">
                                        }
                                        <label class="form-check-label" for="inlineCheckbox3">刹车</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        @if (ser.FaultType.IndexOf("离合器") != -1)
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox4" value="离合器" checked="checked">
                                        }
                                        else
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox4" value="离合器">
                                        }
                                        <label class="form-check-label" for="inlineCheckbox4">离合器</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        @if (ser.FaultType.IndexOf("外观") != -1)
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox5" value="外观" checked="checked">
                                        }
                                        else
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox5" value="外观">
                                        }
                                        <label class="form-check-label" for="inlineCheckbox5">外观</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        @if (ser.FaultType.IndexOf("风挡玻璃") != -1)
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox6" value="风挡玻璃" checked="checked">
                                        }
                                        else
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox6" value="风挡玻璃">
                                        }
                                        <label class="form-check-label" for="inlineCheckbox6">风挡玻璃</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        @if (ser.FaultType.IndexOf("车漆") != -1)
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox7" value="车漆" checked="checked">
                                        }
                                        else
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox7" value="车漆">
                                        }
                                        <label class="form-check-label" for="inlineCheckbox7">车漆</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        @if (ser.FaultType.IndexOf("车轮") != -1)
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox8" value="车轮" checked="checked">
                                        }
                                        else
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox8" value="车轮">
                                        }
                                        <label class="form-check-label" for="inlineCheckbox8">车轮</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        @if (ser.FaultType.IndexOf("异响") != -1)
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox9" value="异响" checked="checked">
                                        }
                                        else
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox9" value="异响">
                                        }
                                        <label class="form-check-label" for="inlineCheckbox9">异响</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        @if (ser.FaultType.IndexOf("异味") != -1)
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox10" value="异味" checked="checked">
                                        }
                                        else
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox10" value="异味">
                                        }
                                        <label class="form-check-label" for="inlineCheckbox10">异味</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        @if (ser.FaultType.IndexOf("渗漏") != -1)
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox11" value="渗漏" checked="checked">
                                        }
                                        else
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox11" value="渗漏">
                                        }
                                        <label class="form-check-label" for="inlineCheckbox11">渗漏</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        @if (ser.FaultType.IndexOf("音响") != -1)
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox12" value="音响" checked="checked">
                                        }
                                        else
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox12" value="音响">
                                        }
                                        <label class="form-check-label" for="inlineCheckbox12">音响</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        @if (ser.FaultType.IndexOf("转向") != -1)
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox13" value="转向" checked="checked">
                                        }
                                        else
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox13" value="转向">
                                        }
                                        <label class="form-check-label" for="inlineCheckbox13">转向</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        @if (ser.FaultType.IndexOf("空调") != -1)
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox14" value="空调" checked="checked">
                                        }
                                        else
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox14" value="空调">
                                        }
                                        <label class="form-check-label" for="inlineCheckbox14">空调</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        @if (ser.FaultType.IndexOf("车内电器") != -1)
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox15" value="车内电器" checked="checked">
                                        }
                                        else
                                        {
                                            <input class="form-check-input" type="checkbox" name="FaultType" id="inlineCheckbox15" value="车内电器">
                                        }
                                        <label class="form-check-label" for="inlineCheckbox15">车内电器</label>
                                    </div>

                                </div>
                            </div>
                            <div class="form-group mb-3">
                                <label for="hour-field">预约时间</label>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="inputGroupPrepend-1">
                                            <i class="batch-icon batch-icon-clock"></i>
                                        </span>
                                    </div>
                                    <input type="text" class="date form-control" name="Appointment" value="@ser.Appointment" id="hour-field" placeholder="YYYY/MM/DD">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="layui-form-label">处理情况</label>
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <label class="input-group-text" for="inputGroupSelect01">Options</label>
                                    </div>
                                    <select class="custom-select" name="DealSituation" id="inputGroupSelect01" lay-verify="required">
                                        @if (ser.DealSituation == 0)
                                        {
                                            <option selected value="0">待处理</option>;
                                        }
                                        else
                                        {
                                            <option selected value="1">已处理</option>;
                                        }
                                        <option value="1">已处理</option>
                                        <option value="0">待处理</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="Note" class="active">备注</label>
                                <textarea class="form-control" name="Note" id="Note"  rows="2">@ser.Note</textarea>
                            </div>
                            <div class="form-group">
                                <label for="UserId" class="active">用户Id</label>
                                <input type="text" class="form-control" id="UserId" name="UserId" value="@ser.UserId" placeholder="UserId">
                            </div>
                            <button id="validate" type="button" class="btn btn-primary" onclick="EditSave()">Validate</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row mb-5">
    <div class="col-md-12">
        <footer>
            Powered by - <a href="http://base5builder.com/?click_source=quillpro_footer_link" target="_blank" style="font-weight:300;color:#ffffff;background:#1d1d1d;padding:0 3px;">Base<span style="color:#ffa733;font-weight:bold">5</span>Builder</a>
        </footer>
    </div>
</div>

<script type="text/javascript">
    function serializeObject(form) {
        var o = {};
        var a = $(form).serializeArray();
        $.each(a, function () {
            if (o[this.name]) {
                if (!o[this.name].push) {
                    o[this.name] = [o[this.name]];
                }
                o[this.name].push(this.value || '');
            } else {
                o[this.name] = this.value || '';
            }
        });
        return o;
    };
    function EditSave() {
        //序列化form
        var data = serializeObject("#formAdd");
        console.log(JSON.stringify(data));
        console.log(data["FaultType"].toString());
        data["FaultType"] = data["FaultType"].toString();
        data["Note"] = data["Note"] + " ";
        $.ajax({

            type: "post",

            dataType: "json",

            url: "/T_Base_Service/editsave",

            data: JSON.stringify(data),

            contentType: "application/json;charset=utf-8",

            success: function (result) {
                if (result.code == 1) {
                    alert(result.message);
                    window.location.href = "List";
                    //self.parent.x_tab_reload("T_Base_Book_List");
                    //self.parent.x_tab_delete("addbook");
                    //self.parent.x_tab_reload("T_Base_Book_List");

                    //处理
                } else {
                    alert(message);
                    //处理错误
                }

            },
            error: function (msg) {
                alert('通讯失败');
            }
        });
    }
</script>


